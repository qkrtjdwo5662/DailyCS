# 자바 컴파일과정

태그: Java

### 자바의 특징

- 자바는 OS에 독립적인 특징을 가지고 있음
- Java Virtual Machine 덕분임 → 밑에서는 이걸 JVM이라고 부르겠음

### 자바 컴파일과정

- 자바 소스코드 .java파일을 작성함
- 자바 컴파일러가 자바 소스파일을 컴파일하면 자바 바이트 코드 .class 파일로 나옴
- 이 바이트 코드는 컴퓨터가 읽을 수 없으며 자바 가상 머신이 이해할 수 있는 코드이다.
    - Opcode와 추가 피연산자로 이루어짐
- 이 컴파일된 바이트 코드를 JVM의 클래스로더에게 전달한다.
- 클래스 로더는 동적로딩을 통해 필요한 클래스들을 로딩 및 링크하여 런타임 데이터 영역(JVM의 메모리에 올린다)
    - 클래스 파일을 가져와서 JVM 메모리에 로드한다.
    - 자바 언어 명세 및 JVM 명세에 명시된 대로 구성되어 있는지를 검사한다.
    - 클래스가 필요로 하는 메모리를 할당한다.
    - 클래스의 상수 풀 내 모든 심볼릭 레퍼런스를 다이렉트 레퍼런스로 변경한다.
    - 클래스 변수들을 적절한 값으로 초기화한다.
- 실행엔진은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와 실행한다.
    - 인터프리터 : 바이트 코드 명령어를 하나씩 읽어서 해석하고 실행함, 이렇기에 전체적인 진행속도가 느리다.
    - JIT 컴파일러 : 바이트 코드 전체를 컴파일하여 바이너리 코드로 변경하고 이후에는 해당 메서드를 더 이상 인프리팅 하는 것이 아닌 바이너리 코드로 직접 실행하는 방식이다. 하나씩 인터프리팅해서 실행하는 것이 아닌 바이너리 코드 전체가 컴파일된 바이너리 코드를 실행하기에 전체적인 실행속도는 인터프리팅 방식보다 빠르다.

<aside>
💡

JRE  : Java Runtime Environment, 자바 실행 환경, JVM + 표준 클래스 라이브러리

JDK : Java Development Kit, JRE + 개발에 필요한 도구

</aside>

<aside>
💡

플랫폼에 독립적

- 추상적이라고 느껴질 수 있음
- 한 번 컴파일하면 어떤 운영체제나 CPU 환경에서도 실행이 가능하다.
- 운영체제위 자바 가상 머신 위에서 바이트 코드를 읽어서 해석됨
- 이러한 장점 덕분에 웹 개발에 활용된다.
- 예시를 보면 마인크래프트는 자바로 만들어졌기에 운영체제에 상관없이 실행이 가능하다.
</aside>

<aside>
💡

자바 컴파일 시점은 언제?

- 실행 및 빌드 하면 그때 .class파일로 컴파일하는 과정에서 검증과정을 거친다.
- 그래서 여기서 문제가 생기면 컴파일 에러가 발생한다.
</aside>

<aside>
💡

JRE는 Node.js와 유사한가?

- 작동방식만 다를뿐 큰 틀에서는 그렇다
</aside>